@startuml

' ========== THESIS STANDARD CONFIGURATION ==========
skinparam handwritten false
skinparam shadowing false
skinparam monochrome true
skinparam defaultFontName Arial
skinparam defaultFontSize 11

skinparam activity {
    StartColor Black
    EndColor Black
    BackgroundColor White
    BorderColor Black
    ArrowColor Black
    DiamondBorderColor Black
    DiamondBackgroundColor White
}

skinparam swimlane {
    BorderColor Black
    TitleBackgroundColor White
    TitleFontColor Black
}

title Activity Diagram: Quy trình thanh toán tiền mặt

|Bệnh nhân|
start
:Đến quầy lễ tân sau khi khám xong;

|Lễ tân|
:Tra cứu hóa đơn của bệnh nhân;
:Xem chi tiết hóa đơn;
:Thông báo tổng số tiền cần thanh toán;

|Bệnh nhân|
:Xác nhận thông tin hóa đơn;
:Đưa tiền thanh toán;

|Lễ tân|
:Nhập số tiền khách đưa;

|Hệ thống|
if (Số tiền >= Tổng tiền?) then ([Có])
    :Bắt đầu transaction;
    :Cập nhật trạng thái: Paid;
    :Ghi nhận phương thức: Tiền mặt;
    :Tính tiền thừa;
    
    :Truy vấn các thuốc trong hóa đơn;
    
    if (Có thuốc trong hóa đơn?) then ([Có])
        :Trừ số lượng tồn kho;
        :Cập nhật thời gian cập nhật;
    else ([Không])
    endif
    
    :Commit transaction;
    :Lưu thông tin thanh toán;
    
    |Lễ tân|
    :Trả tiền thừa cho bệnh nhân;
    :In hóa đơn (nếu cần);
    
    |Bệnh nhân|
    :Nhận tiền thừa và hóa đơn;
    :Hoàn tất thanh toán;
    stop
    
else ([Không])
    :Thông báo số tiền không đủ;
    
    |Lễ tân|
    :Yêu cầu bệnh nhân thanh toán thêm;
    
    |Bệnh nhân|
    :Đưa thêm tiền;
    detach
endif

@enduml
